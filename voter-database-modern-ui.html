<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অমর একুশে হল - ডাকসু ভোটার ডেটাবেস সিস্টেম</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            color: #718096;
            font-size: 1.2rem;
        }
        
        .header .subtitle {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            color: #4a5568;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card h3 {
            color: #2d3748;
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            color: #718096;
            font-weight: 500;
        }
        
        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .controls h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            color: #4a5568;
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #fc5c7d 0%, #6a82fb 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #718096 0%, #4a5568 100%);
            color: white;
        }
        
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }
        
        .excel-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .excel-table th, .excel-table td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        
        .excel-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .excel-table tr:nth-child(even) {
            background-color: #f7fafc;
        }
        
        .excel-table tr:hover {
            background-color: #edf2f7;
        }
        
        .voter-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .voter-photo:hover {
            transform: scale(1.1);
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }
        
        .pagination button {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pagination button:hover {
            background: #667eea;
            color: white;
        }
        
        .pagination button.active {
            background: #667eea;
            color: white;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            max-height: 80%;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .id-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 30px;
            color: white;
            max-width: 600px;
            margin: 0 auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .id-card-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .id-card-body {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 30px;
            align-items: start;
        }
        
        .id-card-photo {
            width: 150px;
            height: 180px;
            border-radius: 10px;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .id-card-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .id-card-field {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .id-card-label {
            font-weight: 600;
            opacity: 0.9;
        }
        
        .id-card-value {
            text-align: right;
            font-weight: 500;
        }
        
        .id-card-footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            font-size: 14px;
            opacity: 0.9;
        }
        
        .photo-gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .photo-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .photo-card:hover {
            transform: translateY(-5px);
        }
        
        .photo-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
        }
        
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .control-group {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="language-toggle">
        <button class="btn btn-secondary" onclick="toggleLanguage()" id="langToggle">🌐 English</button>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 id="mainTitle">🏛️ অমর একুশে হল - ডাকসু ভোটার ডেটাবেস</h1>
            <p id="subtitle">সম্পূর্ণ ভোটার ডেটাবেস ম্যানেজমেন্ট সিস্টেম</p>
            <div class="subtitle">
                <span>📅 ডাকসু ২০২৫</span>
                <span>🏛️ ঢাকা বিশ্ববিদ্যালয়</span>
                <span>✅ ১২৯১ ভোটার</span>
            </div>
        </div>

        <!-- Statistics Dashboard -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3 id="totalVoters">1291</h3>
                <p id="totalVotersLabel">মোট ভোটার</p>
            </div>
            <div class="stat-card">
                <h3 id="totalSessions">7</h3>
                <p id="totalSessionsLabel">মোট সেশন</p>
            </div>
            <div class="stat-card">
                <h3 id="votersWithPhotos">1291</h3>
                <p id="votersWithPhotosLabel">ছবিসহ ভোটার</p>
            </div>
            <div class="stat-card">
                <h3 id="photoRate">100%</h3>
                <p id="photoRateLabel">ছবি সংযুক্তির হার</p>
            </div>
            <div class="stat-card">
                <h3 id="totalDepartments">10</h3>
                <p id="totalDepartmentsLabel">মোট বিভাগ</p>
            </div>
            <div class="stat-card">
                <h3 id="filteredCount">1291</h3>
                <p id="filteredCountLabel">ফিল্টার করা</p>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="controls">
            <h2 id="controlTitle">🛠️ নিয়ন্ত্রণ প্যানেল</h2>
            
            <div class="control-group">
                <div class="form-group">
                    <label id="searchNameLabel">নাম দিয়ে অনুসন্ধান:</label>
                    <input type="text" id="searchName" placeholder="নাম লিখুন..." onkeyup="applyFilters()">
                </div>
                <div class="form-group">
                    <label id="searchVoterLabel">ভোটার নম্বর:</label>
                    <input type="text" id="searchVoterNumber" placeholder="ভোটার নম্বর..." onkeyup="applyFilters()">
                </div>
                <div class="form-group">
                    <label id="sessionFilterLabel">সেশন ফিল্টার:</label>
                    <select id="sessionFilter" onchange="applyFilters()">
                        <option value="">সকল সেশন</option>
                    </select>
                </div>
                <div class="form-group">
                    <label id="departmentFilterLabel">বিভাগ ফিল্টার:</label>
                    <select id="departmentFilter" onchange="applyFilters()">
                        <option value="">সকল বিভাগ</option>
                    </select>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="applyFilters()">🔍 ফিল্টার প্রয়োগ</button>
                <button class="btn btn-secondary" onclick="resetFilters()">🔄 রিসেট</button>
                <button class="btn btn-success" onclick="exportToExcel()">📊 Excel এক্সপোর্ট</button>
                <button class="btn btn-info" onclick="showStatistics()">📈 পরিসংখ্যান</button>
                <button class="btn btn-warning" onclick="generateReport()">📋 রিপোর্ট তৈরি</button>
                <button class="btn btn-primary" onclick="showPhotoGallery()">🖼️ ফটো গ্যালারি</button>
            </div>
        </div>

        <!-- Data Table -->
        <div class="table-container">
            <h2 id="tableTitle">📋 ভোটার তালিকা</h2>
            <div style="overflow-x: auto;">
                <table class="excel-table" id="voterTable">
                    <thead>
                        <tr>
                            <th id="thPhoto">ছবি</th>
                            <th id="thSerial">ক্রমিক</th>
                            <th id="thVoterNumber">ভোটার নম্বর</th>
                            <th id="thName">নাম</th>
                            <th id="thSession">সেশন</th>
                            <th id="thDepartment">বিভাগ</th>
                            <th id="thAction">অ্যাকশন</th>
                        </tr>
                    </thead>
                    <tbody id="voterTableBody">
                    </tbody>
                </table>
            </div>
            
            <!-- Pagination -->
            <div class="pagination" id="pagination"></div>
        </div>
    </div>

    <!-- Modals -->
    <!-- ID Card Modal -->
    <div id="idCardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="idCardTitle">🆔 ভোটার আইডি কার্ড</h2>
                <span class="close" onclick="closeModal('idCardModal')">&times;</span>
            </div>
            <div id="idCardContent"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="printIdCard()">🖨️ প্রিন্ট করুন</button>
                <button class="btn btn-success" onclick="downloadIdCard()">💾 ডাউনলোড করুন</button>
            </div>
        </div>
    </div>

    <!-- Statistics Modal -->
    <div id="statisticsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="statsModalTitle">📊 বিস্তারিত পরিসংখ্যান</h2>
                <span class="close" onclick="closeModal('statisticsModal')">&times;</span>
            </div>
            <div id="statisticsContent"></div>
        </div>
    </div>

    <!-- Photo Gallery Modal -->
    <div id="photoGalleryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="galleryTitle">🖼️ ভোটারদের ছবির গ্যালারি</h2>
                <span class="close" onclick="closeModal('photoGalleryModal')">&times;</span>
            </div>
            <div id="photoGalleryContent" class="photo-gallery-grid"></div>
        </div>
    </div>

    <!-- Report Generator Modal -->
    <div id="reportGeneratorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="reportGenTitle">📊 রিপোর্ট জেনারেটর</h2>
                <span class="close" onclick="closeModal('reportGeneratorModal')">&times;</span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h3>⚙️ রিপোর্ট কনফিগারেশন</h3>
                    <div class="form-group">
                        <label>📄 রিপোর্টের ধরন:</label>
                        <select id="reportType" onchange="updateReportPreview()">
                            <option value="summary">📊 সারসংক্ষেপ রিপোর্ট</option>
                            <option value="detailed">📃 বিস্তারিত তালিকা</option>
                            <option value="statistical">📊 পরিসংখ্যানগত বিশ্লেষণ</option>
                            <option value="department">🏢 বিভাগীয় রিপোর্ট</option>
                            <option value="session">🗓️ সেশনীয় রিপোর্ট</option>
                            <option value="voter-cards">🆔 ভোটার কার্ড তালিকা</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>🎯 রিপোর্টের পরিসর:</label>
                        <select id="reportScope" onchange="updateReportPreview()">
                            <option value="all">🌍 সমস্ত ভোটার</option>
                            <option value="filtered">🔍 বর্তমান ফিলটারকৃত</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>📄 ফর্ম্যাট:</label>
                        <select id="reportFormat">
                            <option value="html">🌐 HTML (ওয়েব পেজ)</option>
                            <option value="pdf">📄 PDF (প্রিন্ট)</option>
                            <option value="excel">📈 Excel</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="generateCustomReport()" style="width: 100%; margin-top: 10px;">
                        🚀 রিপোর্ট তৈরি করুন
                    </button>
                </div>
                <div>
                    <h3>👁️ লাইভ প্রিভিউ</h3>
                    <div id="reportPreview" style="border: 2px solid #ddd; border-radius: 8px; padding: 15px; background: #f9f9f9; min-height: 300px; max-height: 400px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Main application variables
        let voterData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 20;
        let currentLanguage = 'bn';

        // Language translations
        const translations = {
            bn: {
                mainTitle: '🏛️ অমর একুশে হল - ডাকসু ভোটার ডেটাবেস',
                subtitle: 'সম্পূর্ণ ভোটার ডেটাবেস ম্যানেজমেন্ট সিস্টেম',
                totalVoters: 'মোট ভোটার',
                totalSessions: 'মোট সেশন',
                votersWithPhotos: 'ছবিসহ ভোটার',
                photoRate: 'ছবি সংযুক্তির হার',
                totalDepartments: 'মোট বিভাগ',
                filteredCount: 'ফিল্টার করা',
                controlTitle: '🛠️ নিয়ন্ত্রণ প্যানেল',
                searchNameLabel: 'নাম দিয়ে অনুসন্ধান:',
                searchVoterLabel: 'ভোটার নম্বর:',
                sessionFilterLabel: 'সেশন ফিল্টার:',
                departmentFilterLabel: 'বিভাগ ফিল্টার:',
                tableTitle: '📋 ভোটার তালিকা',
                thPhoto: 'ছবি',
                thSerial: 'ক্রমিক',
                thVoterNumber: 'ভোটার নম্বর',
                thName: 'নাম',
                thSession: 'সেশন',
                thDepartment: 'বিভাগ',
                thAction: 'অ্যাকশন',
                details: 'বিস্তারিত',
                previous: 'পূর্ববর্তী',
                next: 'পরবর্তী',
                allSessions: 'সকল সেশন',
                allDepartments: 'সকল বিভাগ'
            },
            en: {
                mainTitle: '🏛️ Amar Ekushey Hall - DUCSU Voter Database',
                subtitle: 'Complete Voter Database Management System',
                totalVoters: 'Total Voters',
                totalSessions: 'Total Sessions',
                votersWithPhotos: 'Voters with Photos',
                photoRate: 'Photo Attachment Rate',
                totalDepartments: 'Total Departments',
                filteredCount: 'Filtered',
                controlTitle: '🛠️ Control Panel',
                searchNameLabel: 'Search by Name:',
                searchVoterLabel: 'Voter Number:',
                sessionFilterLabel: 'Session Filter:',
                departmentFilterLabel: 'Department Filter:',
                tableTitle: '📋 Voter List',
                thPhoto: 'Photo',
                thSerial: 'Serial',
                thVoterNumber: 'Voter Number',
                thName: 'Name',
                thSession: 'Session',
                thDepartment: 'Department',
                thAction: 'Action',
                details: 'Details',
                previous: 'Previous',
                next: 'Next',
                allSessions: 'All Sessions',
                allDepartments: 'All Departments'
            }
        };

        // Department translations
        const departmentTranslations = {
            "অণুজীব বিজ্ঞান বিভাগ": "Department of Microbiology",
            "আবহাওয়া বিজ্ঞান বিভাগ": "Department of Meteorology",
            "উদ্ভিদ বিজ্ঞান বিভাগ": "Department of Botany",
            "কম্পিউটার বিজ্ঞান ও প্রকৌশল বিভাগ": "Department of Computer Science & Engineering",
            "অর্থনীতি বিভাগ": "Department of Economics",
            "পদার্থবিজ্ঞান বিভাগ": "Department of Physics",
            "রসায়ন বিভাগ": "Department of Chemistry",
            "গণিত বিভাগ": "Department of Mathematics",
            "সমুদ্র বিজ্ঞান বিভাগ": "Department of Oceanography",
            "ভূগোল ও পরিবেশ বিভাগ": "Department of Geography & Environment"
        };

        // Session translations
        const sessionTranslations = {
            "২০১৮-১৯": "2018-19",
            "২০১৯-২০": "2019-20",
            "২০২০-২১": "2020-21",
            "২০২১-২২": "2021-22",
            "২০২২-২৩": "2022-23",
            "২০২৩-২৪": "2023-24",
            "২০২৪-২৫": "2024-25"
        };

        // Initialize voter data
        function initializeVoterData() {
            voterData = [
                {serial: 1, voterNumber: "এক-০০০০১", name: "ফাহিম রহমান", registrationSession: "২০১৮-১৯", department: "অণুজীব বিজ্ঞান বিভাগ"},
                {serial: 2, voterNumber: "এক-০০০০২", name: "ফাহিম রহমান", registrationSession: "২০১৮-১৯", department: "অণুজীব বিজ্ঞান বিভাগ"},
                {serial: 3, voterNumber: "এক-০০০০৩", name: "ফাহিম রহমান", registrationSession: "২০১৮-১৯", department: "অণুজীব বিজ্ঞান বিভাগ"},
                {serial: 4, voterNumber: "এক-০০০০৪", name: "ফাহিম রহমান", registrationSession: "২০১৯-২০", department: "অণুজীব বিজ্ঞান বিভাগ"},
                {serial: 5, voterNumber: "এক-০০০০৫", name: "মাঃ রিয়াজুল ইসলাম", registrationSession: "২০১৯-২০", department: "অণুজীব বিজ্ঞান বিভাগ"}
            ];
            
            // Generate additional sample data
            const sampleNames = ["আহমেদ আলী", "ফাতিমা খাতুন", "মোহাম্মদ রহিম", "সালমা বেগম", "করিম উদ্দিন", "রাশিদা বেগম", "আবুল কাসেম", "নাসিরউদ্দিন"];
            const sessions = ["২০১৮-১৯", "২০১৯-২০", "২০২০-২১", "২০২১-২২", "২০২২-২৩", "২০২৩-২৪", "২০২৪-২৫"];
            const departments = [
                "অণুজীব বিজ্ঞান বিভাগ", "আবহাওয়া বিজ্ঞান বিভাগ", "উদ্ভিদ বিজ্ঞান বিভাগ", 
                "কম্পিউটার বিজ্ঞান ও প্রকৌশল বিভাগ", "অর্থনীতি বিভাগ", "পদার্থবিজ্ঞান বিভাগ",
                "রসায়ন বিভাগ", "গণিত বিভাগ", "সমুদ্র বিজ্ঞান বিভাগ", "ভূগোল ও পরিবেশ বিভাগ"
            ];
            
            for (let i = voterData.length; i < 1291; i++) {
                voterData.push({
                    serial: i + 1,
                    voterNumber: `এক-${String(i + 1).padStart(5, '0')}`,
                    name: sampleNames[Math.floor(Math.random() * sampleNames.length)],
                    registrationSession: sessions[Math.floor(Math.random() * sessions.length)],
                    department: departments[Math.floor(Math.random() * departments.length)]
                });
            }
            
            filteredData = [...voterData];
        }

        // Get voter photo URL
        function getVoterPhoto(voterNumber) {
            const serial = parseInt(voterNumber.split('-')[1]);
            const photoNumber = String(serial).padStart(4, '0');
            return `images/portrait_${photoNumber}.jpg`;
        }

        // Toggle language
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'bn' ? 'en' : 'bn';
            document.getElementById('langToggle').textContent = currentLanguage === 'bn' ? '🌐 English' : '🌐 বাংলা';
            updateUILanguage();
        }

        // Update UI language
        function updateUILanguage() {
            const t = translations[currentLanguage];
            
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('totalVotersLabel').textContent = t.totalVoters;
            document.getElementById('totalSessionsLabel').textContent = t.totalSessions;
            document.getElementById('votersWithPhotosLabel').textContent = t.votersWithPhotos;
            document.getElementById('photoRateLabel').textContent = t.photoRate;
            document.getElementById('totalDepartmentsLabel').textContent = t.totalDepartments;
            document.getElementById('filteredCountLabel').textContent = t.filteredCount;
            document.getElementById('controlTitle').textContent = t.controlTitle;
            document.getElementById('searchNameLabel').textContent = t.searchNameLabel;
            document.getElementById('searchVoterLabel').textContent = t.searchVoterLabel;
            document.getElementById('sessionFilterLabel').textContent = t.sessionFilterLabel;
            document.getElementById('departmentFilterLabel').textContent = t.departmentFilterLabel;
            document.getElementById('tableTitle').textContent = t.tableTitle;
            document.getElementById('thPhoto').textContent = t.thPhoto;
            document.getElementById('thSerial').textContent = t.thSerial;
            document.getElementById('thVoterNumber').textContent = t.thVoterNumber;
            document.getElementById('thName').textContent = t.thName;
            document.getElementById('thSession').textContent = t.thSession;
            document.getElementById('thDepartment').textContent = t.thDepartment;
            document.getElementById('thAction').textContent = t.thAction;
            
            displayTable();
        }

        // Update statistics
        function updateStatistics() {
            document.getElementById('totalVoters').textContent = voterData.length;
            document.getElementById('totalSessions').textContent = [...new Set(voterData.map(v => v.registrationSession))].length;
            document.getElementById('votersWithPhotos').textContent = voterData.length;
            document.getElementById('photoRate').textContent = '100%';
            document.getElementById('totalDepartments').textContent = [...new Set(voterData.map(v => v.department))].length;
            document.getElementById('filteredCount').textContent = filteredData.length;
        }

        // Populate filters
        function populateFilters() {
            const sessionFilter = document.getElementById('sessionFilter');
            const departmentFilter = document.getElementById('departmentFilter');
            const t = translations[currentLanguage];
            
            // Populate session filter
            const sessions = [...new Set(voterData.map(v => v.registrationSession))].sort();
            sessionFilter.innerHTML = `<option value="">${t.allSessions}</option>`;
            sessions.forEach(session => {
                const displaySession = currentLanguage === 'en' ? (sessionTranslations[session] || session) : session;
                sessionFilter.innerHTML += `<option value="${session}">${displaySession}</option>`;
            });
            
            // Populate department filter
            const departments = [...new Set(voterData.map(v => v.department))].sort();
            departmentFilter.innerHTML = `<option value="">${t.allDepartments}</option>`;
            departments.forEach(department => {
                const displayDept = currentLanguage === 'en' ? (departmentTranslations[department] || department) : department;
                departmentFilter.innerHTML += `<option value="${department}">${displayDept}</option>`;
            });
        }

        // Apply filters
        function applyFilters() {
            const nameSearch = document.getElementById('searchName').value.toLowerCase();
            const voterNumberSearch = document.getElementById('searchVoterNumber').value.toLowerCase();
            const sessionFilter = document.getElementById('sessionFilter').value;
            const departmentFilter = document.getElementById('departmentFilter').value;
            
            filteredData = voterData.filter(voter => {
                const matchesName = !nameSearch || voter.name.toLowerCase().includes(nameSearch);
                const matchesVoterNumber = !voterNumberSearch || voter.voterNumber.toLowerCase().includes(voterNumberSearch);
                const matchesSession = !sessionFilter || voter.registrationSession === sessionFilter;
                const matchesDepartment = !departmentFilter || voter.department === departmentFilter;
                
                return matchesName && matchesVoterNumber && matchesSession && matchesDepartment;
            });
            
            currentPage = 1;
            updateStatistics();
            displayTable();
        }

        // Reset filters
        function resetFilters() {
            document.getElementById('searchName').value = '';
            document.getElementById('searchVoterNumber').value = '';
            document.getElementById('sessionFilter').value = '';
            document.getElementById('departmentFilter').value = '';
            applyFilters();
        }

        // Display table
        function displayTable() {
            const tbody = document.getElementById('voterTableBody');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);
            const t = translations[currentLanguage];
            
            tbody.innerHTML = '';
            
            pageData.forEach(voter => {
                const row = tbody.insertRow();
                const photoUrl = getVoterPhoto(voter.voterNumber);
                const displayName = voter.name;
                const displaySession = currentLanguage === 'en' ? (sessionTranslations[voter.registrationSession] || voter.registrationSession) : voter.registrationSession;
                const displayDept = currentLanguage === 'en' ? (departmentTranslations[voter.department] || voter.department) : voter.department;
                
                row.innerHTML = `
                    <td style="text-align: center;">
                        <img src="${photoUrl}" alt="${displayName}" class="voter-photo" 
                             onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22%23ddd%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 font-size=%2240%22>👤</text></svg>'"
                             onclick="showLargePhoto('${photoUrl}', '${displayName}', '${voter.voterNumber}')">
                    </td>
                    <td>${voter.serial}</td>
                    <td><strong>${voter.voterNumber}</strong></td>
                    <td>${displayName}</td>
                    <td>${displaySession}</td>
                    <td style="font-size: 0.9rem;">${displayDept}</td>
                    <td>
                        <button class="btn btn-info" style="padding: 8px 16px; font-size: 14px;" onclick="showVoterDetails('${voter.voterNumber}')">${t.details}</button>
                    </td>
                `;
            });
            
            updatePagination();
        }

        // Update pagination
        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const pagination = document.getElementById('pagination');
            const t = translations[currentLanguage];
            
            pagination.innerHTML = '';
            
            if (currentPage > 1) {
                const prevBtn = document.createElement('button');
                prevBtn.textContent = t.previous;
                prevBtn.onclick = () => { currentPage--; displayTable(); };
                pagination.appendChild(prevBtn);
            }
            
            for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                const pageBtn = document.createElement('button');
                pageBtn.textContent = i;
                pageBtn.className = i === currentPage ? 'active' : '';
                pageBtn.onclick = () => { currentPage = i; displayTable(); };
                pagination.appendChild(pageBtn);
            }
            
            if (currentPage < totalPages) {
                const nextBtn = document.createElement('button');
                nextBtn.textContent = t.next;
                nextBtn.onclick = () => { currentPage++; displayTable(); };
                pagination.appendChild(nextBtn);
            }
        }

        // Show voter details
        function showVoterDetails(voterNumber) {
            const voter = voterData.find(v => v.voterNumber === voterNumber);
            if (voter) {
                generateIdCard(voter);
                document.getElementById('idCardModal').style.display = 'block';
            }
        }

        // Generate ID card
        function generateIdCard(voter) {
            const photoUrl = getVoterPhoto(voter.voterNumber);
            const displayName = voter.name;
            const displaySession = currentLanguage === 'en' ? (sessionTranslations[voter.registrationSession] || voter.registrationSession) : voter.registrationSession;
            const displayDept = currentLanguage === 'en' ? (departmentTranslations[voter.department] || voter.department) : voter.department;
            
            const idCardHtml = `
                <div class="id-card">
                    <div class="id-card-header">
                        <h3>${currentLanguage === 'en' ? 'University of Dhaka' : 'ঢাকা বিশ্ববিদ্যালয়'}</h3>
                        <p>${currentLanguage === 'en' ? 'Amar Ekushey Hall - DUCSU Voter ID' : 'অমর একুশে হল - ডাকসু ভোটার আইডি'}</p>
                    </div>
                    <div class="id-card-body">
                        <img src="${photoUrl}" alt="${displayName}" class="id-card-photo"
                             onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23ddd%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 font-size=%2240%22>👤</text></svg>'">
                        <div class="id-card-details">
                            <div class="id-card-field">
                                <span class="id-card-label">${currentLanguage === 'en' ? 'Name:' : 'নাম:'}</span>
                                <span class="id-card-value">${displayName}</span>
                            </div>
                            <div class="id-card-field">
                                <span class="id-card-label">${currentLanguage === 'en' ? 'ID:' : 'আইডি:'}</span>
                                <span class="id-card-value">${voter.voterNumber}</span>
                            </div>
                            <div class="id-card-field">
                                <span class="id-card-label">${currentLanguage === 'en' ? 'Serial:' : 'ক্রমিক:'}</span>
                                <span class="id-card-value">${voter.serial}</span>
                            </div>
                            <div class="id-card-field">
                                <span class="id-card-label">${currentLanguage === 'en' ? 'Session:' : 'সেশন:'}</span>
                                <span class="id-card-value">${displaySession}</span>
                            </div>
                            <div class="id-card-field">
                                <span class="id-card-label">${currentLanguage === 'en' ? 'Department:' : 'বিভাগ:'}</span>
                                <span class="id-card-value">${displayDept}</span>
                            </div>
                        </div>
                    </div>
                    <div class="id-card-footer">
                        ${currentLanguage === 'en' ? 'Issued:' : 'প্রদত্ত:'} ${new Date().toLocaleDateString(currentLanguage === 'en' ? 'en-US' : 'bn-BD')}
                    </div>
                </div>
            `;
            
            document.getElementById('idCardContent').innerHTML = idCardHtml;
        }

        // Export to Excel
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['ক্রমিক', 'ভোটার নম্বর', 'নাম', 'রেজিস্ট্রেশন সেশন', 'বিভাগ']
            ];
            
            filteredData.forEach(voter => {
                wsData.push([
                    voter.serial,
                    voter.voterNumber,
                    voter.name,
                    voter.registrationSession,
                    voter.department
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, "ভোটার তালিকা");
            XLSX.writeFile(wb, 'অমর_একুশে_হল_ভোটার_ডেটাবেস.xlsx');
        }

        // Show statistics
        function showStatistics() {
            const modal = document.getElementById('statisticsModal');
            const content = document.getElementById('statisticsContent');
            
            const sessionStats = {};
            const departmentStats = {};
            
            filteredData.forEach(voter => {
                sessionStats[voter.registrationSession] = (sessionStats[voter.registrationSession] || 0) + 1;
                departmentStats[voter.department] = (departmentStats[voter.department] || 0) + 1;
            });
            
            content.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div>
                        <h3>${currentLanguage === 'en' ? 'Session Distribution' : 'সেশন বিতরণ'}</h3>
                        ${Object.entries(sessionStats).map(([session, count]) => 
                            `<p><strong>${session}:</strong> ${count} ${currentLanguage === 'en' ? 'people' : 'জন'}</p>`
                        ).join('')}
                    </div>
                    <div>
                        <h3>${currentLanguage === 'en' ? 'Department Distribution' : 'বিভাগ বিতরণ'}</h3>
                        ${Object.entries(departmentStats).sort((a, b) => b[1] - a[1]).slice(0, 10).map(([dept, count]) => 
                            `<p><strong>${dept.substring(0, 30)}:</strong> ${count} ${currentLanguage === 'en' ? 'people' : 'জন'}</p>`
                        ).join('')}
                    </div>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        // Show photo gallery
        function showPhotoGallery() {
            const modal = document.getElementById('photoGalleryModal');
            const content = document.getElementById('photoGalleryContent');
            
            content.innerHTML = '';
            
            filteredData.slice(0, 50).forEach(voter => {
                const photoUrl = getVoterPhoto(voter.voterNumber);
                const photoCard = document.createElement('div');
                photoCard.className = 'photo-card';
                
                photoCard.innerHTML = `
                    <img src="${photoUrl}" alt="${voter.name}"
                         onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23ddd%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 font-size=%2240%22>👤</text></svg>'"
                         onclick="showLargePhoto('${photoUrl}', '${voter.name}', '${voter.voterNumber}')">
                    <h4 style="margin: 10px 0 5px 0; color: #2d3748;">${voter.name}</h4>
                    <p style="margin: 0; color: #718096; font-size: 14px;">${voter.voterNumber}</p>
                `;
                
                content.appendChild(photoCard);
            });
            
            modal.style.display = 'block';
        }

        // Show large photo
        function showLargePhoto(photoUrl, name, voterNumber) {
            alert(`${name}\n${voterNumber}`);
        }

        // Generate report
        function generateReport() {
            document.getElementById('reportGeneratorModal').style.display = 'block';
            updateReportPreview();
        }

        // Update report preview
        function updateReportPreview() {
            const reportType = document.getElementById('reportType').value;
            const reportScope = document.getElementById('reportScope').value;
            const dataToUse = reportScope === 'all' ? voterData : filteredData;
            
            const preview = document.getElementById('reportPreview');
            preview.innerHTML = `
                <h4>রিপোর্ট প্রিভিউ</h4>
                <p><strong>ধরন:</strong> ${reportType}</p>
                <p><strong>মোট রেকর্ড:</strong> ${dataToUse.length}</p>
                <p><strong>তারিখ:</strong> ${new Date().toLocaleDateString('bn-BD')}</p>
            `;
        }

        // Generate custom report
        function generateCustomReport() {
            const reportFormat = document.getElementById('reportFormat').value;
            
            if (reportFormat === 'excel') {
                exportToExcel();
            } else {
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(`
                    <html>
                    <head>
                        <title>DUCSU Voter Report</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 40px; }
                            h1 { color: #667eea; }
                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                            th { background-color: #667eea; color: white; }
                        </style>
                    </head>
                    <body>
                        <h1>অমর একুশে হল - ভোটার রিপোর্ট</h1>
                        <p>তারিখ: ${new Date().toLocaleDateString('bn-BD')}</p>
                        <p>মোট ভোটার: ${filteredData.length}</p>
                        <table>
                            <tr><th>ক্রমিক</th><th>ভোটার নম্বর</th><th>নাম</th><th>সেশন</th><th>বিভাগ</th></tr>
                            ${filteredData.slice(0, 100).map(v => 
                                `<tr><td>${v.serial}</td><td>${v.voterNumber}</td><td>${v.name}</td><td>${v.registrationSession}</td><td>${v.department}</td></tr>`
                            ).join('')}
                        </table>
                    </body>
                    </html>
                `);
            }
            closeModal('reportGeneratorModal');
        }

        // Print ID card
        function printIdCard() {
            window.print();
        }

        // Download ID card
        function downloadIdCard() {
            alert('ID card download feature - implement canvas conversion');
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Initialize application
        window.onload = function() {
            initializeVoterData();
            updateStatistics();
            populateFilters();
            displayTable();
        };

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };
    </script>
</body>
</html>